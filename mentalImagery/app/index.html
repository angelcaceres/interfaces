<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Estimulaci√≥n: Imagineria Mental</title>

    <!-- Estilos -->
    <link rel="stylesheet" href="styles/mentalImgStyle.css">

    <!-- Insert this line above script imports  -->
    <script>if (typeof module === 'object') { window.module = module; module = undefined; };</script>

    <script src="../jquery.js"></script>

    <!--jQuery-->
    <script src="scripts/openbci.js"></script> <!-- Funciones para trabajar con Cyton -->
    <script src="scripts/p300Stimulation.js"></script> <!-- Funciones para iniciar el protocolo P300 -->

    <!-- Insert this line after script imports -->
    <script>if (window.module) module = window.module;</script>


</head>

<body style="background-color:grey;">

    <script>
        $(function () {
            $("#ProtocoloP300").load("p300.html");
        });
    </script>

    <div class='fullscreenDiv'>
        <div class="center" id="text"></div>
    </div>

    <!-- Vista Protocolo P300 (Eric) -->
    <div id="ProtocoloP300" >
    </div>
    <!-- Vista Protocolo P300 (Eric) -->

</body>

<script>
    $(document).ready(function () {
        var udp = require('dgram');

        var server = udp.createSocket('udp4');

        // En caso de error
        server.on('error', (err) => {
            console.error("Error:", err);
            server.close();
            process.exit();
        })

        // En caso de que 
        server.on('listening', function () {
            var address = server.address();
            var port = address.port;
            var family = address.family;
            var ipaddr = address.address;
            $(".menu-server > p").text("Escuchando puerto: " + port);
            console.log('Server is listening at port ' + port);
            console.log('Server ip :' + ipaddr);
            console.log('Server is IP4/IP6 : ' + family);
        });


        // Se llama cuando llega un nuevo datagram msg
        server.on('message', function (msg, info) {
            console.log('Data received from client : ' + msg.toString());
            console.log('Received %d bytes from %s:%d\n', msg.length, info.address, info.port);
        });

        server.bind();
    })
</script>

</html>